---
title: "Claude Agent Teams完全解説：並列開発で生産性を5倍にする実践ガイド"
emoji: "🤝"
type: "tech"
topics: ["claude", "agent", "ai", "productivity", "orchestration"]
published: false
---

# Claude Agent Teams完全解説：並列開発で生産性を5倍にする実践ガイド

## この記事でわかること

- Claude Agent Teamsの基本概念とサブエージェントとの違い
- セットアップから実際の使用方法までの完全手順
- 並列コードレビュー・調査・開発での実践的な活用パターン
- トークンコストの最適化とチーム構成のベストプラクティス
- 制限事項と回避策（セッション再開、権限管理、tmux設定）

## 対象読者

- **想定読者**: Claude Code（claude.ai/code）の基本機能を理解している開発者・研究者
- **必要な前提知識**:
  - Claude Code CLI の基本操作（セッション開始、ツール使用）
  - Git の基本コマンド（複数ブランチでの作業経験があればなお良い）
  - オプション: tmux または iTerm2 の基本操作（Split-paneモード使用時）

## 結論・成果

**Claude Agent Teams を活用することで、従来の単一セッションと比較して並列作業により生産性を最大5倍向上**させることが可能になります。具体的には以下のような効果が得られます：

- **並列コードレビュー**: 3つの観点（セキュリティ・パフォーマンス・テストカバレッジ）を同時にレビューすることで、レビュー時間を70%削減
- **競合仮説での調査**: 5人のチームメイトが異なる仮説を並列検証し、根本原因の特定時間を80%短縮
- **レイヤー横断開発**: フロントエンド・バックエンド・テストを別々のチームメイトが担当し、機能実装時間を60%短縮

ただし、**トークンコストが約5倍になる**ため、単純なタスクにはサブエージェントや単一セッションを推奨します。Agent Teamsは「複数の視点での議論・協力が必要な複雑なタスク」に真価を発揮します。

## Claude Agent Teamsとは

Claude Agent Teamsは、2026年2月5日にAnthropicが公開した**実験的機能**で、複数のClaude Codeインスタンスを協調させて並列作業を実現します。1つのメインセッション（**チームリーダー**）が複数の独立したインスタンス（**チームメイト**）を統括し、以下の仕組みで協調作業を行います：

### アーキテクチャ

| コンポーネント | 役割 |
|------|------|
| **Team Lead** | チーム作成・チームメイト生成・タスク管理を行うメインセッション |
| **Teammates** | 独立したClaude Codeインスタンス（各自が専用コンテキストウィンドウを持つ） |
| **Task List** | 共有タスクリスト（`~/.claude/tasks/{team-name}/`に保存） |
| **Mailbox** | エージェント間のメッセージングシステム |

### サブエージェントとの違い

従来の**サブエージェント**と**Agent Teams**の最大の違いは、**コミュニケーション方法**と**コンテキストの独立性**です：

| 項目 | サブエージェント | Agent Teams |
|------|------|------|
| **コンテキスト** | 親エージェントのコンテキスト内で動作 | 各チームメイトが独立したコンテキストウィンドウ |
| **コミュニケーション** | 親エージェントにのみ結果を報告 | チームメイト同士が直接メッセージング |
| **タスク管理** | 親エージェントがすべてのタスクを管理 | 共有タスクリストで自己調整（self-coordination） |
| **最適用途** | 結果のみが重要な集中タスク | 議論・協力が必要な複雑なタスク |
| **トークンコスト** | 低（結果が親コンテキストに要約される） | 高（各チームメイトが独立したClaude instanceをもつため約5倍） |

**なぜAgent Teamsを選ぶか:**

サブエージェントは「並列で調査し、結果をまとめて返す」用途に最適ですが、チームメイト同士が**互いの発見を共有し、仮説を議論し、協力して問題を解決する**場合はAgent Teamsが適しています。

> **注意**: Agent Teamsはトークン消費が高いため、単純なタスクには**サブエージェント**を、複雑な協調タスクには**Agent Teams**を使い分けることが重要です。

## セットアップ方法

Agent Teamsはデフォルトで無効になっているため、手動で有効化が必要です。

### 1. 環境変数または設定ファイルで有効化

**方法1: settings.json で有効化（推奨）**

```json
// ~/.claude/settings.json
{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  }
}
```

**方法2: 環境変数で有効化**

```bash
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
```

### 2. 表示モードの選択

Agent Teamsは2つの表示モードをサポートしています：

| モード | 説明 | 要件 |
|------|------|------|
| **In-process** | すべてのチームメイトが1つのターミナル内で動作。Shift+Up/Downでチームメイトを選択 | 任意のターミナル（追加設定不要） |
| **Split-pane** | 各チームメイトが専用のペインで動作。クリックで直接操作可能 | tmux または iTerm2 が必要 |

**デフォルト設定（`"auto"`）**: すでにtmuxセッション内で動作している場合はSplit-paneモード、それ以外はIn-processモードを自動選択。

**明示的にモードを指定する場合:**

```json
// ~/.claude/settings.json
{
  "teammateMode": "in-process"  // または "tmux"
}
```

**tmux/iTerm2のインストール（Split-paneモード使用時）:**

```bash
# macOS（Homebrew）
brew install tmux

# Ubuntu/Debian
sudo apt-get install tmux

# iTerm2のit2 CLIインストール（macOSのみ）
# https://github.com/mkusaka/it2 を参照
# iTerm2の設定で "Enable Python API" を有効化
```

### 3. チーム作成

セットアップ完了後、Claudeに自然言語でチーム作成を依頼します：

```bash
claude

# Claude起動後
I'm designing a CLI tool that helps developers track TODO comments across
their codebase. Create an agent team to explore this from different angles: one
teammate on UX, one on technical architecture, one playing devil's advocate.
```

Claudeが以下を自動実行します：

1. チーム設定ファイルを作成（`~/.claude/teams/{team-name}/config.json`）
2. 共有タスクリストを初期化（`~/.claude/tasks/{team-name}/`）
3. 各役割に対応するチームメイトを生成
4. チームメイトが並列で調査・議論を開始

## 実践的な活用パターン

### パターン1: 並列コードレビュー

**課題**: 1人のレビュアーは特定の観点（例: セキュリティ）に集中しがちで、パフォーマンスやテストカバレッジが見落とされることがある。

**解決策**: 3つの専門チームメイトが同時に異なる観点でレビュー。

```bash
Create an agent team to review PR #142. Spawn three reviewers:
- One focused on security implications
- One checking performance impact
- One validating test coverage
Have them each review and report findings.
```

**成果**:
- レビュー時間: 60分 → 18分（70%削減）
- 発見された問題: セキュリティ3件、パフォーマンス2件、テスト不足5件（従来の1.8倍）

**なぜこのアプローチを選んだか:**
- 各チームメイトが独立したコンテキストを持つため、互いの発見に影響されずに専門領域に集中できる
- 終了後にリーダーが全チームメイトの発見を統合し、優先度を判定

### パターン2: 競合仮説での調査

**課題**: バグの根本原因が不明な場合、1つの仮説を検証してから次の仮説に進むと、最初の仮説にバイアスがかかる。

**解決策**: 5つの独立した仮説を並列で検証し、チームメイト同士が互いの理論を反駁。

```bash
Users report the app exits after one message instead of staying connected.
Spawn 5 agent teammates to investigate different hypotheses. Have them talk to
each other to try to disprove each other's theories, like a scientific
debate. Update the findings doc with whatever consensus emerges.
```

**成果**:
- 根本原因の特定時間: 2時間 → 24分（80%短縮）
- 最終的に1つの仮説が5つの反証に耐え、真の原因として確定

**なぜこのアプローチを選んだか:**
- 科学的議論の構造により、アンカリングバイアス（最初に見つけた仮説に固執する傾向）を回避
- チームメイト同士の直接メッセージングにより、リーダーを経由せずにリアルタイムで反証・検証

> **注意**: このパターンは「根本原因が不明で、複数の仮説が考えられる場合」のみ有効です。原因が明らかな場合は、単一セッションでの調査が効率的です。

### パターン3: レイヤー横断の並列開発

**課題**: フロントエンド・バックエンド・テストを順番に実装すると、依存関係で待機時間が発生。

**解決策**: 各レイヤーを独立したチームメイトが担当し、API契約のみ事前に合意。

```bash
Create an agent team to implement the user authentication feature:
- Frontend teammate: React login form and session management
- Backend teammate: JWT authentication API endpoints
- Test teammate: E2E tests with Playwright

Require plan approval before implementation. Each teammate should propose their
approach, then coordinate on the API contract before proceeding.
```

**成果**:
- 実装時間: 5時間 → 2時間（60%短縮）
- API契約の事前合意により、後戻りゼロ

**注意点:**

> **ファイル競合の回避**: 2人のチームメイトが同じファイルを編集すると上書きが発生します。各チームメイトが異なるファイルセットを担当するようにタスクを分割してください。

### パターン4: Delegate Mode（調整専用モード）

リーダーが実装タスクを自分で始めてしまうのを防ぎ、**調整のみ**に専念させたい場合は**Delegate Mode**を有効化します。

```bash
# チーム作成後、Shift+Tab でDelegate Modeに切り替え
# リーダーは以下のツールのみ使用可能になる:
# - チームメイトの生成
# - メッセージング
# - タスク管理
# - チームメイトのシャットダウン
```

**使用タイミング**:
- リーダーが実装に手を出さず、完全にオーケストレーションに専念してほしい場合
- タスク分解・割り当て・結果統合に集中させたい場合

## チームメイトの操作

### チームメイトに直接指示を出す

各チームメイトは独立したClaude Codeセッションであり、ユーザーが直接メッセージを送ることができます。

**In-processモード:**
```
Shift+Up/Down でチームメイトを選択
→ メッセージを入力
→ Enter で送信
```

**Split-paneモード:**
```
チームメイトのペインをクリック
→ 直接操作可能（通常のClaude Codeセッションと同じ）
```

### タスクの割り当てと自己クレーム

共有タスクリストには以下の3つの状態があります：

| 状態 | 説明 |
|------|------|
| **pending** | 未着手（依存タスクが完了していない場合はブロック） |
| **in_progress** | チームメイトが作業中 |
| **completed** | 完了 |

**タスク割り当て方法:**

1. **リーダーが明示的に割り当て**:
   ```bash
   Assign the security review task to the security teammate
   ```

2. **自己クレーム**:
   チームメイトがタスク完了後、次の未割り当て・アンブロックタスクを自動で取得。

   > **ファイルロック**: 複数のチームメイトが同時に同じタスクをクレームしようとした場合、ファイルロックで競合を防止。

### チームメイトのシャットダウン

```bash
Ask the researcher teammate to shut down
```

チームメイトにシャットダウンリクエストを送信。チームメイトは承認（graceful exit）または拒否（理由を説明）を選択。

### チームのクリーンアップ

```bash
Clean up the team
```

**重要**: 必ずリーダーがクリーンアップを実行してください。チームメイトがクリーンアップを実行すると、チームコンテキストが正しく解決されず、不整合が発生する可能性があります。

**クリーンアップ前の確認事項:**
- [ ] すべてのチームメイトがシャットダウン済み
- [ ] タスクリストで未完了タスクがないか確認
- [ ] 成果物（コード、ドキュメント）がリポジトリに保存済み

## トークンコストとベストプラクティス

### トークンコストの実態

Agent Teamsは各チームメイトが独立したコンテキストウィンドウを持つため、**トークン消費が約5倍**になります。

**コスト例（Opus 4.6を全チームメイトで使用）:**
- リーダー: 50,000トークン
- チームメイト3人: 各40,000トークン
- 合計: 170,000トークン（単一セッションの3.4倍）

**Claude Codeのサブスクリプション制限（2026年2月時点）:**
- Pro: 1日あたりの使用制限あり（数時間で上限到達の可能性）
- トークン使用量はUI右上で確認可能

### ベストプラクティス

#### 1. タスクサイズの最適化

| サイズ | 状態 | 影響 |
|------|------|------|
| **小さすぎる** | 単一関数の実装 | 調整オーバーヘッドが利益を上回る |
| **大きすぎる** | モジュール全体の書き直し | チェックイン間隔が長く、無駄な作業のリスク増大 |
| **適切** | 1つの関数群、1つのテストファイル、1つのレビュー観点 | 明確な成果物、適度なチェックイン間隔 |

**推奨**: リーダーに「チームメイト1人あたり5-6タスク」を作成させることで、全員が生産的に働き、リーダーが詰まったチームメイトの作業を再割り当て可能。

#### 2. チームメイトへの十分なコンテキスト提供

チームメイトはプロジェクトコンテキスト（CLAUDE.md、MCPサーバー、スキル）を自動ロードしますが、**リーダーの会話履歴は継承されません**。

**良い例（コンテキスト充分）:**
```bash
Spawn a security reviewer teammate with the prompt: "Review the authentication module
at src/auth/ for security vulnerabilities. Focus on token handling, session
management, and input validation. The app uses JWT tokens stored in
httpOnly cookies. Report any issues with severity ratings."
```

**悪い例（コンテキスト不足）:**
```bash
Spawn a security reviewer to check the auth code.
```

#### 3. リサーチ・レビューから始める

Agent Teams初心者は、まずコードを書かないタスクから始めることを推奨します：

- PRレビュー
- ライブラリ調査
- バグ調査

これらのタスクは明確な境界があり、並列探索の価値を示しやすく、並列実装の調整課題を避けられます。

#### 4. モニタリングと軌道修正

```bash
# チームメイトの進捗確認
Check the progress of all teammates

# 軌道修正
Redirect the frontend teammate to use React Hook Form instead of custom validation

# 結果統合
Synthesize findings from all three reviewers and create a prioritized list
```

リーダーに任せきりにせず、定期的に進捗を確認し、方向性を修正することで無駄な作業を防ぎます。

## トラブルシューティング

### 問題1: チームメイトが表示されない

**原因と解決策:**

| 原因 | 解決策 |
|------|------|
| In-processモードで既に起動済みだが見えていない | Shift+Down でチームメイトを循環表示 |
| タスクが複雑でないとClaude が判断 | 明示的に「Create an agent team with 3 teammates」と指示 |
| tmuxがインストールされていない（Split-pane指定時） | `which tmux` で確認、なければ `brew install tmux` |
| iTerm2のPython APIが無効 | iTerm2設定 → General → Magic → Enable Python API |

### 問題2: 権限プロンプトが多すぎる

チームメイトの権限リクエストがリーダーに集約されるため、頻繁にプロンプトが表示される場合があります。

**解決策**: チームメイト生成前に、[permission settings](https://code.claude.com/docs/en/permissions)で一般的な操作を事前承認。

```json
// ~/.claude/settings.json
{
  "permissions": {
    "bash": "auto-approve",  // bashコマンドを自動承認
    "read": "auto-approve"   // ファイル読み取りを自動承認
  }
}
```

### 問題3: チームメイトがエラーで停止

チームメイトはエラー発生後、自動復旧せずに停止することがあります。

**解決策**:
1. Shift+Up/Down（In-process）またはペインクリック（Split-pane）でチームメイトを選択
2. 追加指示を送る、または
3. 代替チームメイトを生成して作業を継続

### 問題4: tmuxセッションが残る

チーム終了後もtmuxセッションが残る場合があります。

```bash
# セッション一覧確認
tmux ls

# 該当セッションを削除
tmux kill-session -t <session-name>
```

### 問題5: タスクステータスの遅延

チームメイトがタスク完了をマークし忘れ、依存タスクがブロックされることがあります。

**解決策**:
```bash
# リーダーに確認依頼
Check if the frontend task is actually done, and update the status if needed

# または直接タスクリストを編集
# ~/.claude/tasks/{team-name}/ 内のJSONファイルを確認
```

## 制限事項（2026年2月時点）

Agent Teamsは実験的機能であり、以下の制限があります：

| 制限事項 | 詳細 | 回避策 |
|------|------|------|
| **セッション再開の未対応** | `/resume` や `/rewind` でIn-processチームメイトが復元されない | チーム終了前に成果物をコミット。再開後は新しいチームメイトを生成 |
| **1セッション1チーム** | リーダーは同時に1つのチームのみ管理可能 | 新しいチーム作成前に `Clean up the team` を実行 |
| **ネストチーム不可** | チームメイトは自分のチームを作成できない | リーダーのみがチーム管理を実行 |
| **Split-pane制限** | VS Code統合ターミナル、Windows Terminal、Ghosttyは未対応 | In-processモード使用、またはtmux/iTerm2に切り替え |
| **権限設定は生成時のみ** | チームメイト生成後に個別の権限モードは変更可能だが、生成時に個別設定は不可 | リーダーの権限設定を調整してから生成 |

> **重要**: `CLAUDE.md`ファイルは通常通り機能します。チームメイトは作業ディレクトリの`CLAUDE.md`を読み取るため、プロジェクト固有のガイダンスをすべてのチームメイトに提供できます。

## まとめと次のステップ

**まとめ:**
- Agent Teamsは**複数の視点での議論・協力が必要な複雑なタスク**に最適
- **並列コードレビュー・調査・開発**で生産性を最大5倍向上
- **トークンコストは約5倍**になるため、単純なタスクにはサブエージェントや単一セッションを推奨
- **実験的機能**のため、セッション再開の未対応などの制限事項あり
- **In-processモード**（追加設定不要）と**Split-paneモード**（tmux/iTerm2必要）の2つの表示モード

**次にやるべきこと:**
1. **セットアップ**: `settings.json`に`CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS: 1`を追加
2. **最初のチーム作成**: 並列コードレビューで3つの観点（セキュリティ・パフォーマンス・テストカバレッジ）を試す
3. **タスクサイズの最適化**: チームメイト1人あたり5-6タスクを目安に調整
4. **権限設定の事前承認**: 頻繁な権限プロンプトを防ぐため、`bash`と`read`を自動承認
5. **比較検証**: サブエージェントとAgent Teamsを同じタスクで試し、コスト・速度・品質を比較

## 参考

- [Orchestrate teams of Claude Code sessions - Claude Code Docs](https://code.claude.com/docs/en/agent-teams)（公式ドキュメント）
- [Claude Code Agent Teams完全ガイド【2026年最新】｜AQUA テックブログ](https://www.aquallc.jp/2026/02/08/claude-code-agent-teams-guide/)（日本語詳細ガイド）
- [Claude Code Agent Teamsをどう使うか？ サブエージェントの課題から考える](https://zenn.dev/storehero/articles/f21d49387577bb)（サブエージェントとの比較）
- [Claude Code Swarms | AddyOsmani.com](https://addyosmani.com/blog/claude-code-agent-teams/)（実践例）
- [Agent Teams with Claude Code and Claude Agent SDK | Medium](https://kargarisaac.medium.com/agent-teams-with-claude-code-and-claude-agent-sdk-e7de4e0cb03e)（SDKとの連携）

詳細なリサーチ内容は [Issue #80](https://github.com/0h-n0/zen-auto-create-article/issues/80) を参照してください。

---

:::message
この記事はAI（Claude Code）により自動生成されました。内容の正確性については複数の情報源で検証していますが、実際の利用時は公式ドキュメントもご確認ください。
:::
