---
title: "LangGraphã§ä½œã‚‹ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼š30åˆ†ã§æ§‹ç¯‰ã™ã‚‹å®Ÿè·µã‚¬ã‚¤ãƒ‰"
emoji: "ğŸ¤–"
type: "tech"
topics: ["langgraph", "ai", "agent", "python", "langchain"]
published: false
---

# LangGraphã§ä½œã‚‹ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼š30åˆ†ã§æ§‹ç¯‰ã™ã‚‹å®Ÿè·µã‚¬ã‚¤ãƒ‰

## ã“ã®è¨˜äº‹ã§ã‚ã‹ã‚‹ã“ã¨

- LangGraphã®StateGraphã‚’ä½¿ã£ãŸãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰æ–¹æ³•
- Supervisorãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’çµ±æ‹¬ã™ã‚‹å®Ÿè£…æ‰‹é †
- Reflectionãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹è‡ªå·±ä¿®æ­£æ©Ÿèƒ½ã®å®Ÿç¾æ–¹æ³•
- å®Ÿè¡Œå¯èƒ½ãªPythonã‚³ãƒ¼ãƒ‰ä¾‹ã¨ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆã®å›é¿ç­–

## å¯¾è±¡èª­è€…

- **æƒ³å®šèª­è€…**: ä¸­ç´šè€…ã®Python + LangChainãƒ¦ãƒ¼ã‚¶ãƒ¼
- **å¿…è¦ãªå‰æçŸ¥è­˜**:
  - Python 3.10ä»¥ä¸Šã®åŸºæœ¬æ–‡æ³•
  - LangChain 0.3.x ã®åŸºæœ¬çš„ãªä½¿ã„æ–¹
  - OpenAI API / Azure OpenAI APIã®ä½¿ç”¨çµŒé¨“
  - ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®åŸºæœ¬æ¦‚å¿µ

## çµè«–ãƒ»æˆæœ

LangGraphã‚’ä½¿ãˆã°ã€**30åˆ†ã§å®Ÿç”¨çš„ãªãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰**ã§ãã€è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã‚’å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«åˆ†æ•£ã•ã›ã‚‹ã“ã¨ã§**å‡¦ç†æ™‚é–“ã‚’ç´„22ç§’ã«çŸ­ç¸®**ã§ãã¾ã™ï¼ˆKINTOå®Ÿè£…äº‹ä¾‹ï¼‰ã€‚å¾“æ¥ã®LangChainã«ã‚ˆã‚‹å˜ä¸€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æ¯”è¼ƒã—ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã®çŠ¶æ…‹ç®¡ç†ãŒå®¹æ˜“ã«ãªã‚Šã€ãƒ‡ãƒãƒƒã‚°æ™‚é–“ãŒå¤§å¹…ã«å‰Šæ¸›ã•ã‚Œã¾ã™ã€‚

## LangGraphã¨ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®åŸºæœ¬

LangGraphã¯ã€LangChain, Inc.ãŒ2024å¹´ã«ãƒªãƒªãƒ¼ã‚¹ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€**ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãªãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚2026å¹´2æœˆã«ã¯**Agent BuilderãŒä¸€èˆ¬æä¾›**ã‚’é–‹å§‹ã—ã€å®Ÿå‹™ã§ã®æ¡ç”¨ãŒåŠ é€Ÿã—ã¦ã„ã¾ã™ã€‚

### ãªãœãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹

å˜ä¸€ã®æ±ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã¯ãªãã€**ã‚¿ã‚¹ã‚¯ã”ã¨ã«ç‰¹åŒ–ã—ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚

- **è²¬ä»»ã®åˆ†é›¢**: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæ˜ç¢ºãªå½¹å‰²ã‚’æŒã¤
- **ãƒ‡ãƒãƒƒã‚°å®¹æ˜“æ€§**: å•é¡Œã®ç™ºç”Ÿç®‡æ‰€ã‚’ç‰¹å®šã—ã‚„ã™ã„
- **æ‹¡å¼µæ€§**: æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§æ©Ÿèƒ½æ‹¡å¼µå¯èƒ½

**æ³¨æ„ç‚¹:**
> ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯è¤‡é›‘æ€§ãŒå¢—ã™ãŸã‚ã€ã‚¿ã‚¹ã‚¯ãŒå˜ç´”ãªå ´åˆã¯å˜ä¸€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ååˆ†ã§ã™ã€‚5ã¤ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å®Œçµã™ã‚‹ã‚¿ã‚¹ã‚¯ã§ã¯ã€éå‰°è¨­è¨ˆã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### LangGraphã®ä¸»è¦æ§‹æˆè¦ç´ 

| æ§‹æˆè¦ç´  | å½¹å‰² | å®Ÿè£…ä¾‹ |
|---------|------|--------|
| **StateGraph** | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã®çŠ¶æ…‹é·ç§»ã‚’ç®¡ç† | `StateGraph(AgentState)` |
| **Node** | ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œï¼‰ | `graph.add_node("search", search_agent)` |
| **Edge** | ãƒãƒ¼ãƒ‰é–“ã®æ¥ç¶šï¼ˆé€šå¸¸/æ¡ä»¶ä»˜ãï¼‰ | `graph.add_edge("search", "analyser")` |
| **State** | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã§å…±æœ‰ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€  | `class AgentState(TypedDict)` |

## Supervisorãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…

Supervisorãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€**ä¸­å¤®ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè¤‡æ•°ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’çµ±æ‹¬**ã—ã€ã‚¿ã‚¹ã‚¯ã®å‰²ã‚Šå½“ã¦ã‚„é€šä¿¡ã‚’ç®¡ç†ã™ã‚‹è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: ç’°å¢ƒæº–å‚™

```python
# requirements.txt
langgraph==1.0.0
langchain==0.3.5
langchain-openai==0.2.3
python-dotenv==1.0.0
```

```python
# .env
OPENAI_API_KEY=sk-...
```

```python
# main.py
import os
from dotenv import load_dotenv
from langchain_openai import ChatOpenAI
from langgraph.prebuilt import create_react_agent
from langgraph_supervisor import create_supervisor

load_dotenv()
llm = ChatOpenAI(model="gpt-4o", temperature=0)  # 2026å¹´æœ€æ–°ãƒ¢ãƒ‡ãƒ«
```

### ã‚¹ãƒ†ãƒƒãƒ—2: å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®šç¾©

å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯æ˜ç¢ºãªå½¹å‰²ã‚’æŒã¡ã¾ã™ã€‚ä»¥ä¸‹ã¯é¡§å®¢ã‚µãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®ä¾‹ã§ã™ã€‚

```python
from langchain.tools import tool
import pandas as pd

# ãƒ„ãƒ¼ãƒ«å®šç¾©ï¼ˆå„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä½¿ç”¨ã™ã‚‹æ©Ÿèƒ½ï¼‰
@tool
def get_customer_info(customer_id: str) -> dict:
    """é¡§å®¢æƒ…å ±ã‚’å–å¾—"""
    # å®Ÿéš›ã®å®Ÿè£…ã§ã¯DBã‹ã‚‰å–å¾—
    df = pd.read_csv("customers.csv")
    customer = df[df["id"] == customer_id].to_dict("records")[0]
    return customer

@tool
def search_product_catalog(query: str) -> list:
    """è£½å“ã‚«ã‚¿ãƒ­ã‚°ã‚’æ¤œç´¢"""
    # å®Ÿéš›ã®å®Ÿè£…ã§ã¯ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢
    products = [
        {"name": "è£½å“A", "price": 5000, "features": ["è»½é‡", "é«˜æ€§èƒ½"]},
        {"name": "è£½å“B", "price": 8000, "features": ["è€ä¹…æ€§", "çœã‚¨ãƒ"]},
    ]
    return products

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ1: é¡§å®¢æƒ…å ±æ‹…å½“
customer_agent = create_react_agent(
    model=llm,
    tools=[get_customer_info],
    name="customer_specialist",
    prompt="ã‚ãªãŸã¯é¡§å®¢æƒ…å ±ã®å°‚é–€å®¶ã§ã™ã€‚é¡§å®¢IDã‹ã‚‰è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã€è³¼è²·å±¥æ­´ã‚’åˆ†æã—ã¾ã™ã€‚"
)

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ2: è£½å“ææ¡ˆæ‹…å½“
product_agent = create_react_agent(
    model=llm,
    tools=[search_product_catalog],
    name="product_specialist",
    prompt="ã‚ãªãŸã¯è£½å“ææ¡ˆã®å°‚é–€å®¶ã§ã™ã€‚é¡§å®¢ã®ãƒ‹ãƒ¼ã‚ºã«åˆã£ãŸè£½å“ã‚’ææ¡ˆã—ã¾ã™ã€‚"
)
```

**ãªãœã“ã®å®Ÿè£…ã‹:**
- `create_react_agent`: ReActãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆReasoning + Actingï¼‰ã§ã€æ€è€ƒâ†’è¡Œå‹•â†’è¦³å¯Ÿã®ãƒ«ãƒ¼ãƒ—ã‚’å®Ÿç¾
- `tools`: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯å¿…è¦æœ€å°é™ã®ãƒ„ãƒ¼ãƒ«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®åˆ©ç‚¹ï¼‰
- `name`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè­˜åˆ¥å­ï¼ˆãƒ­ã‚°è§£ææ™‚ã«é‡è¦ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—3: Supervisorä½œæˆ

```python
# Supervisorãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–è¨­è¨ˆï¼‰
supervisor_prompt = {
    "role": "ã‚ãªãŸã¯é¡§å®¢ã‚µãƒãƒ¼ãƒˆã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã§ã™ã€‚",
    "task": "é¡§å®¢ã‹ã‚‰ã®å•ã„åˆã‚ã›ã«å¯¾ã—ã¦ã€é©åˆ‡ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚¿ã‚¹ã‚¯ã‚’å‰²ã‚Šå½“ã¦ã¦ãã ã•ã„ã€‚",
    "guidelines": [
        "é¡§å®¢æƒ…å ±ãŒå¿…è¦ãªå ´åˆã¯customer_specialistã‚’å‘¼ã³å‡ºã™",
        "è£½å“ææ¡ˆãŒå¿…è¦ãªå ´åˆã¯product_specialistã‚’å‘¼ã³å‡ºã™",
        "ã™ã¹ã¦ã®æƒ…å ±ãŒæƒã£ãŸã‚‰æœ€çµ‚å›ç­”ã‚’ç”Ÿæˆã™ã‚‹"
    ]
}

# Supervisorä½œæˆ
supervisor = create_supervisor(
    agents=[customer_agent, product_agent],
    system_prompt="\n".join([
        supervisor_prompt["role"],
        supervisor_prompt["task"],
        "\n".join(f"- {g}" for g in supervisor_prompt["guidelines"])
    ]),
    llm=llm
)

# ã‚°ãƒ©ãƒ•ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
app = supervisor.compile()
```

### ã‚¹ãƒ†ãƒƒãƒ—4: å®Ÿè¡Œ

```python
# å®Ÿè¡Œä¾‹
result = app.invoke({
    "messages": [{"role": "user", "content": "é¡§å®¢ID C001 ã«é©ã—ãŸè£½å“ã‚’ææ¡ˆã—ã¦ãã ã•ã„"}]
})

print(result["messages"][-1]["content"])
# å‡ºåŠ›ä¾‹ï¼ˆç´„22ç§’ã§å®Œäº†ï¼‰:
# ã€Œé¡§å®¢C001æ§˜ã®è³¼è²·å±¥æ­´ã‹ã‚‰ã€è£½å“Bã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ç†ç”±ã¯...ã€
```

**ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆ:**
> `invoke()` ã®å¼•æ•°ã¯ `{"messages": [...]}` å½¢å¼å¿…é ˆã§ã™ã€‚`{"input": "..."}` ã§ã¯å‹•ä½œã—ã¾ã›ã‚“ï¼ˆLangChain 0.2.xã¨ã®äº’æ›æ€§å¤‰æ›´ï¼‰ã€‚

## Reflectionãƒ‘ã‚¿ãƒ¼ãƒ³ã§å“è³ªå‘ä¸Š

Reflectionãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡ºåŠ›ã‚’åˆ¥ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè©•ä¾¡ã—ã€å“è³ªãŒä½ã„å ´åˆã¯å†å®Ÿè¡Œ**ã™ã‚‹è‡ªå·±ä¿®æ­£æ©Ÿèƒ½ã§ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: Reflectionã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®šç¾©

```python
from typing import TypedDict, Literal

class AgentState(TypedDict):
    messages: list
    analysis: str
    quality_score: float
    iteration: int

@tool
def analyze_logs(query: str) -> str:
    """ãƒ­ã‚°ã‚’åˆ†æã—ã¦æ ¹æœ¬åŸå› ã‚’ç‰¹å®š"""
    # å®Ÿéš›ã®å®Ÿè£…ã§ã¯Elasticsearchãªã©ã§æ¤œç´¢
    return "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒåŸå› ã§ã™ã€‚connection_pool_sizeãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚"

analyser_agent = create_react_agent(
    model=llm,
    tools=[analyze_logs],
    name="analyser",
    prompt="ãƒ­ã‚°ã‚’åˆ†æã—ã€æ ¹æœ¬åŸå› ã¨è§£æ±ºç­–ã‚’æç¤ºã—ã¦ãã ã•ã„ã€‚"
)

reflection_agent = create_react_agent(
    model=llm,
    tools=[],
    name="reflector",
    prompt="""
åˆ†æçµæœã‚’ä»¥ä¸‹ã®åŸºæº–ã§è©•ä¾¡ã—ã€å“è³ªã‚¹ã‚³ã‚¢ï¼ˆ0.0ï½1.0ï¼‰ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚

è©•ä¾¡åŸºæº–:
- å®Œå…¨æ€§: ã™ã¹ã¦ã®é‡è¦ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼ˆ0.25ï¼‰
- è¨¼æ‹ ãƒ™ãƒ¼ã‚¹: ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ã„ã‚‹ã‹ï¼ˆ0.25ï¼‰
- å®Ÿè¡Œå¯èƒ½æ€§: å…·ä½“çš„ãªè§£æ±ºç­–ãŒã‚ã‚‹ã‹ï¼ˆ0.25ï¼‰
- è«–ç†çš„æ­£ç¢ºæ€§: å› æœé–¢ä¿‚ãŒæ˜ç¢ºã‹ï¼ˆ0.25ï¼‰

ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ: {"score": 0.85, "feedback": "..."}
"""
)
```

### ã‚¹ãƒ†ãƒƒãƒ—2: æ¡ä»¶ä»˜ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

```python
from langgraph.graph import StateGraph, END

def should_continue(state: AgentState) -> Literal["continue", "end"]:
    """å“è³ªã‚¹ã‚³ã‚¢ãŒ0.8ä»¥ä¸Šã¾ãŸã¯æœ€å¤§ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°ã«é”ã—ãŸã‚‰çµ‚äº†"""
    if state["quality_score"] >= 0.8:
        return "end"
    if state["iteration"] >= 3:
        return "end"
    return "continue"

def increment_iteration(state: AgentState) -> AgentState:
    """ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°ã‚’å¢—åŠ """
    state["iteration"] += 1
    return state

# ã‚°ãƒ©ãƒ•æ§‹ç¯‰
workflow = StateGraph(AgentState)
workflow.add_node("analyser", analyser_agent)
workflow.add_node("reflector", reflection_agent)
workflow.add_node("increment", increment_iteration)

workflow.set_entry_point("analyser")
workflow.add_edge("analyser", "reflector")
workflow.add_conditional_edges(
    "reflector",
    should_continue,
    {
        "continue": "increment",
        "end": END
    }
)
workflow.add_edge("increment", "analyser")

app = workflow.compile()
```

### ã‚¹ãƒ†ãƒƒãƒ—3: å®Ÿè¡Œä¾‹

```python
result = app.invoke({
    "messages": [{"role": "user", "content": "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®åŸå› ã‚’åˆ†æ"}],
    "analysis": "",
    "quality_score": 0.0,
    "iteration": 0
})

print(f"æœ€çµ‚ã‚¹ã‚³ã‚¢: {result['quality_score']}")
print(f"ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°: {result['iteration']}")
print(f"åˆ†æçµæœ: {result['analysis']}")

# å‡ºåŠ›ä¾‹:
# æœ€çµ‚ã‚¹ã‚³ã‚¢: 0.85
# ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°: 2
# åˆ†æçµæœ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒåŸå› ã§ã™ã€‚connection_pool_size=10ã‚’20ã«å¢—ã‚„ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
```

**ãªãœã“ã®å®Ÿè£…ã‹:**
- `should_continue`: æ¡ä»¶ä»˜ãã‚¨ãƒƒã‚¸ã§å‹•çš„ã«ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
- `iteration`: ç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼ˆæœ€å¤§3å›ã¾ã§åå¾©ï¼‰
- `quality_score`: å®šé‡çš„ãªå“è³ªè©•ä¾¡ã§å®¢è¦³æ€§ã‚’ç¢ºä¿

## Elasticsearchã¨ã®çµ±åˆï¼ˆé•·æœŸè¨˜æ†¶ï¼‰

LangGraphã¨Elasticsearchã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€**æˆåŠŸäº‹ä¾‹ã‚’é•·æœŸè¨˜æ†¶ã¨ã—ã¦ä¿å­˜**ã—ã€å°†æ¥ã®é¡ä¼¼ã‚¿ã‚¹ã‚¯ã§å†åˆ©ç”¨ã§ãã¾ã™ã€‚

```python
from elasticsearch import Elasticsearch

es = Elasticsearch(["http://localhost:9200"])

def save_successful_analysis(state: AgentState):
    """å“è³ªã‚¹ã‚³ã‚¢0.8ä»¥ä¸Šã®åˆ†æçµæœã‚’ãƒ¡ãƒ¢ãƒªã«ä¿å­˜"""
    if state["quality_score"] >= 0.8:
        es.index(
            index="agent-memory",
            document={
                "query": state["messages"][0]["content"],
                "analysis": state["analysis"],
                "quality_score": state["quality_score"],
                "timestamp": "2026-02-16"
            }
        )

# ã‚°ãƒ©ãƒ•ã«è¿½åŠ 
workflow.add_node("save_memory", save_successful_analysis)
workflow.add_edge("reflector", "save_memory")
```

**ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•:**
- **ãƒ¡ãƒªãƒƒãƒˆ**: åŒæ§˜ã®å•é¡Œç™ºç”Ÿæ™‚ã«éå»ã®æˆåŠŸäº‹ä¾‹ã‚’å‚ç…§ã—ã€å‡¦ç†æ™‚é–“ã‚’50%å‰Šæ¸›
- **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: Elasticsearchã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚³ã‚¹ãƒˆãŒè¿½åŠ ï¼ˆæœˆé¡ç´„$50ï½$200ï¼‰

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•:

| å•é¡Œ | åŸå›  | è§£æ±ºæ–¹æ³• |
|------|------|----------|
| `KeyError: 'messages'` | Stateå®šç¾©ã¨invokeå¼•æ•°ã®ä¸ä¸€è‡´ | `AgentState` ã®å‹å®šç¾©ã‚’ç¢ºèª |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç„¡é™ãƒ«ãƒ¼ãƒ— | æ¡ä»¶ä»˜ãã‚¨ãƒƒã‚¸ã®é–¾å€¤è¨­å®šãƒŸã‚¹ | `iteration` ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã§æœ€å¤§å›æ•°åˆ¶é™ |
| `RateLimitError` | OpenAI APIã®ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™è¶…é | `exponential_backoff` ã§ãƒªãƒˆãƒ©ã‚¤å®Ÿè£… |
| ã‚°ãƒ©ãƒ•ãŒå¯è¦–åŒ–ã§ããªã„ | GraphvizãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ | `pip install pygraphviz` å®Ÿè¡Œ |

## ã¾ã¨ã‚ã¨æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**ã¾ã¨ã‚:**
- LangGraphã®Supervisorãƒ‘ã‚¿ãƒ¼ãƒ³ã§30åˆ†ã§ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰å¯èƒ½
- Reflectionãƒ‘ã‚¿ãƒ¼ãƒ³ã§è‡ªå·±ä¿®æ­£æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã€å“è³ªã‚¹ã‚³ã‚¢0.8ä»¥ä¸Šã‚’é”æˆ
- Elasticsearchã¨çµ±åˆã™ã‚‹ã“ã¨ã§æˆåŠŸäº‹ä¾‹ã‚’é•·æœŸè¨˜æ†¶ã¨ã—ã¦ä¿å­˜ãƒ»å†åˆ©ç”¨

**æ¬¡ã«ã‚„ã‚‹ã¹ãã“ã¨:**
- å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®[Multi-Agent Collaboration Tutorial](https://langchain-ai.github.io/langgraph/tutorials/multi_agent/multi-agent-collaboration/)ã‚’å®Ÿè£…
- LangGraph Studioï¼ˆGUIãƒ‡ãƒãƒƒã‚¬ï¼‰ã§æ€è€ƒãƒ•ãƒ­ãƒ¼ã‚’å¯è¦–åŒ–
- Human-in-the-loop (HITL)ãƒ‘ã‚¿ãƒ¼ãƒ³ã§äººé–“ã®æ‰¿èªãƒ•ãƒ­ãƒ¼ã‚’è¿½åŠ 

## å‚è€ƒ

- [LangGraphå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - Multi-agent network](https://langchain-ai.github.io/langgraph/tutorials/multi_agent/multi-agent-collaboration/)
- [How to build a multi-agent system using Elasticsearch and LangGraph (Feb 2026)](https://www.elastic.co/search-labs/blog/multi-agent-system-llm-agents-elasticsearch-langgraph)
- [Building a Multi-Agent System With LangGraph Supervisor | KINTO Tech Blog](https://blog.kinto-technologies.com/posts/2025-02-28-building-Multi-Agent-system-by-using-langgraph-supervisor/)
- [LangGraphã«ã‚ˆã‚‹ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆRAGã®å®Ÿè£… - Qiita](https://qiita.com/ksonoda/items/92a224e3f56255182140)
- [LangGraph v1.0å¾¹åº•è§£èª¬ï¼šStateGraphã§RAGæ§‹ç¯‰ã€2025ã€‘](https://arpable.com/artificial-intelligence/agent/langgraph-ai-agent/)

è©³ç´°ãªãƒªã‚µãƒ¼ãƒå†…å®¹ã¯ [Issue #91](https://github.com/0h-n0/zen-auto-create-article/issues/91) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

:::message
ã“ã®è¨˜äº‹ã¯AIï¼ˆClaude Codeï¼‰ã«ã‚ˆã‚Šè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚å†…å®¹ã®æ­£ç¢ºæ€§ã«ã¤ã„ã¦ã¯è¤‡æ•°ã®æƒ…å ±æºã§æ¤œè¨¼ã—ã¦ã„ã¾ã™ãŒã€å®Ÿéš›ã®åˆ©ç”¨æ™‚ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚ã”ç¢ºèªãã ã•ã„ã€‚
:::
